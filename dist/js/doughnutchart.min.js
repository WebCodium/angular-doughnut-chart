angular.module("angular-doughnut-chart",[]).directive("doughnutChart",["$animateCss","$timeout",function(t,e){"use strict";var n={stroke:14},s={index:0,isSupported:!(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect),getPercent:function(t,e){return(100-t)*e/100},getLengthCircle:function(t){return Math.floor(2*Math.PI*t)},setSize:function(t,e){return{width:2*t+e,height:2*t+e}},setCircleAttrs:function(t,e){return{r:t,cx:t+e/2,cy:t+e/2}},getClass:function(){return"doughnut-chart-"+this.index++}},r={restrict:"E",scope:{percentage:"=",stroke:"="}};return s.isSupported?angular.extend(r,{link:function(r,a){function i(){r.dashOffset=s.getPercent(r.percentage,r.length)}function c(){r.animate=!0,t(a.find("circle").eq(1),{addClass:"doughnut-allow-animation"}).start().then(i)}function o(t){e(function(){r.radius=(document.querySelectorAll("."+r["class"])[0].offsetWidth-r.stroke)/2,r.length=s.getLengthCircle(r.radius),r.dashOffset=r.length,a.find("svg").attr(s.setSize(r.radius,r.stroke));var e=a.find("circle").attr(s.setCircleAttrs(r.radius,r.stroke));t&&(e.eq(1).removeClass("doughnut-allow-animation"),i())})}r.stroke=r.stroke||n.stroke,r["class"]||(r["class"]=s.getClass()),t(a.children(),{addClass:r["class"]}).start().then(o),r.percentage&&c(),r.$watch("percentage",function(t,e){t!==e&&(r.percentage=t,r.animate?(a.find("circle").eq(1).addClass("doughnut-allow-animation"),i()):c())}),angular.element(window).on("resize",function(){o(!0)})},template:'<div class="doughnut-chart-wrapper" ng-show="percentage"><div class="dough-text-suffix"><span class="dough-text">{{percentage}}</span><sup class="dough-suffix">%</sup></div><svg xmlns="http://www.w3.org/2000/svg"><circle fill="none" class="circle-bg" stroke-width="{{stroke}}"/><circle fill="none" class="circle-animation" stroke-width="{{stroke}}" style="stroke-dasharray: {{length}}; stroke-dashoffset: {{dashOffset}}"/></svg></div>'}):angular.extend(r,{template:'<div class="doughnut-chart-wrapper">Not supported</div>'})}]);